sudo: false
dist: trusty
language: node_js
env:
  - BROWSER=Chrome_travis_ci
  - BROWSER=bs_safari_11
matrix:
  allow_failures:
    - env: BROWSER=bs_safari_11
addons:
  chrome: stable
before_install:
  - export CHROME_BIN=google-chrome-stable
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.1.0
  - export PATH=$HOME/.yarn/bin:$PATH
install:
  # Clone the repository with specified GIT SHA
  # This eventually needs to be replaced with FOLIO URL after transfer of ownership
  - git clone --branch=master https://github.com/folio-org/ui-eholdings.git
  - cd ui-eholdings
  - yarn
cache:
  yarn: true
script:
  - yarn lint
  - yarn test --single-run --browsers=$BROWSER
before_deploy:
  - NODE_ENV=production yarn build
deploy:
  provider: s3
  acl: public_read
  cache_control: max-age=30
  # These access keys should not be exposed in Git checkins
  # Use `travis encrypt...` before committing
  access_key_id: AKIAJPCMT5BOKFDIIAQQ
  secret_access_key:
    secure: dmoRcuRsyFuX879ABcqu7ZOnvJMAOimiSvg+oO/NZ70G0EPXLKTUeNYLGPx/jYYnPxSDZMwdaWSO/d0sZAWJK4LAPSqSA7MkpOZ/Wx+wAuwkhzdBODiaMHXmiAqf7S2eibDa5N+539xz04bpFenKXc7hWgdJj8JYUF6H26GQE2YBJYDgGlClCk1YMoUGwLiUCTLtkadnc82rNygxkrJnn5hwIKQqru3uL2QHryIRAuL40y1yQlFQTyEHRP5Q05+jr+dpJn7CAyHeEkVWvKr7b5NDdPWS0gwneM28LtoLasVvG4aSGwcar2ukQUN64BI37uZ7DUnV27v5Zdw7Wbc+oJlCIOh9CrDJO1ysgCls7Uza9Hv0aplC5UO42BIEur/Z/jJ01OawbivHcKxE98UsMTGEUbXMu8DUHx7ptJca8ICYjIIgH3VRfjhokVao/wa6HyY4qCkF74S2iH4qY/pzT9Cw3rB6vcDCiXsNctVyn9OyjcL/LmOWwbzbP3XOUG6+N4IutK82nvoGfqgP8HyrfJZBpH9HCPQ18hfR/wU8VarQGNXhJ+jbIfUo4G8YU75BgNhjLgtq7fIb7Pqfr8tABZdTBSMC+CTnbmFbLW2y9FSk/I32WAyBZ6Br10lz9uwZiVZsUsG93UsGeB/NJAOuTO3Hnyb+UEhucwXxYxfuxWA=
  bucket: folio.frontside.io
  region: us-east-2
  skip_cleanup: true
  local_dir: dist
  on:
    branch: master
notifications:
  webhooks:
    urls:
      - https://fs-bitbot.herokuapp.com/travis
